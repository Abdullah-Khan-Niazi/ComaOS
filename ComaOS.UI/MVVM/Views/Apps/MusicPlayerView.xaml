<UserControl x:Class="ComaOS.UI.MVVM.Views.Apps.MusicPlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="400" d:DesignWidth="400"
             Background="Transparent"
             Loaded="UserControl_Loaded"
             Unloaded="UserControl_Unloaded">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Album Art Area -->
        <Border Background="#252535" CornerRadius="8" Margin="20">
            <Grid>
                <TextBlock x:Name="AlbumArt" Text="ðŸŽµ" FontSize="120" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                <!-- Visualizer bars (animated) -->
                <StackPanel x:Name="Visualizer" Orientation="Horizontal" 
                            HorizontalAlignment="Center" VerticalAlignment="Bottom" 
                            Margin="0,0,0,20" Visibility="Collapsed">
                    <Border x:Name="Bar1" Width="8" Height="20" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar2" Width="8" Height="35" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar3" Width="8" Height="25" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar4" Width="8" Height="40" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar5" Width="8" Height="30" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar6" Width="8" Height="45" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar7" Width="8" Height="28" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                    <Border x:Name="Bar8" Width="8" Height="38" Background="#60a5fa" CornerRadius="2" Margin="2"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Track Info -->
        <StackPanel Grid.Row="1" HorizontalAlignment="Center" Margin="0,0,0,15">
            <TextBlock x:Name="TrackTitle" Text="No Track Selected" FontSize="18" 
                       Foreground="White" HorizontalAlignment="Center" FontWeight="SemiBold"/>
            <TextBlock x:Name="TrackArtist" Text="Select a track to play" FontSize="13" 
                       Foreground="#888" HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- Progress Bar -->
        <Grid Grid.Row="2" Margin="20,0,20,15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Slider x:Name="ProgressSlider" Minimum="0" Maximum="100" Value="0" 
                    Style="{StaticResource ModernSliderStyle}"
                    ValueChanged="ProgressSlider_ValueChanged"/>
            <Grid Grid.Row="1" Margin="0,5,0,0">
                <TextBlock x:Name="CurrentTime" Text="0:00" Foreground="#666" FontSize="11"/>
                <TextBlock x:Name="TotalTime" Text="0:00" Foreground="#666" FontSize="11" HorizontalAlignment="Right"/>
            </Grid>
        </Grid>

        <!-- Controls -->
        <Grid Grid.Row="3" Margin="20,0,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Volume -->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="ðŸ”Š" FontSize="14" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <Slider x:Name="VolumeSlider" Width="80" Minimum="0" Maximum="100" Value="75" 
                        Style="{StaticResource ModernSliderStyle}" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Playback Controls -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="ðŸ”€" Click="Shuffle_Click" Style="{StaticResource MediaControlButtonStyle}" Width="40"/>
                <Button Content="â®" Click="Previous_Click" Style="{StaticResource MediaControlButtonStyle}" Width="45"/>
                <Button x:Name="PlayButton" Content="â–¶" Click="PlayPause_Click" 
                        Style="{StaticResource PlayButtonStyle}" Width="55" Height="55"/>
                <Button Content="â­" Click="Next_Click" Style="{StaticResource MediaControlButtonStyle}" Width="45"/>
                <Button Content="ðŸ”" Click="Repeat_Click" Style="{StaticResource MediaControlButtonStyle}" Width="40"/>
            </StackPanel>

            <!-- Playlist Toggle -->
            <Button Grid.Column="2" Content="ðŸ“‹" Click="Playlist_Click" 
                    Style="{StaticResource MediaControlButtonStyle}" 
                    HorizontalAlignment="Right" Width="40"/>
        </Grid>

        <!-- Playlist Popup -->
        <Border x:Name="PlaylistPanel" Grid.RowSpan="4" 
                Background="#1a1a2a" Visibility="Collapsed"
                Margin="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <Border Background="#252535" Padding="10">
                    <Grid>
                        <TextBlock Text="ðŸ“‹ Playlist" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                        <Button Content="âœ•" Click="ClosePlaylist_Click" HorizontalAlignment="Right"
                                Style="{StaticResource ToolbarButtonStyle}" Width="30"/>
                    </Grid>
                </Border>
                
                <ListBox x:Name="PlaylistBox" Grid.Row="1" 
                         Background="Transparent" BorderThickness="0"
                         SelectionChanged="PlaylistBox_SelectionChanged">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="Padding" Value="10,8"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#3a3a5a"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#2a2a4a"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="ðŸŽµ" FontSize="14"/>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding Title}" FontSize="13"/>
                                    <TextBlock Text="{Binding Artist}" FontSize="11" Foreground="#666"/>
                                </StackPanel>
                                <TextBlock Grid.Column="2" Text="{Binding Duration}" Foreground="#666" FontSize="11" VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>
    </Grid>
</UserControl>
